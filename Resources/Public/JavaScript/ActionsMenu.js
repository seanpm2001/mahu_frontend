const ActionsMenu=function(e,t,s){let i=null,n="";t||(t={handler:function(e,t){},menuOptions:[]}),t.additionalCssClasses||(t.additionalCssClasses={}),t.headerText&&t.headerText.length>0&&(n+='<div class="actionsMenuHeaderText">'+t.headerText+"</div>"),Array.isArray(t.menuOptions)&&(n+='<div><a class="actionsMenuButton no-change" tabindex="0" title="'+Localization.getString("close")+'"><i class="fas fa-times" aria-hidden="true"></i></a></div>',t.menuOptions.forEach(function(e){e.cssClasses?n+='<div><a id="'+e.id+'" tabindex="0" class="no-change'+(e.cssClasses.link?" "+e.cssClasses.link:"")+'"><i class="'+e.cssClasses.icon+'" aria-hidden="true"></i>'+e.label+"</a></div>":n+='<div><a id="'+e.id+'" tabindex="0" class="no-change"><i aria-hidden="true"></i>'+e.label+"</a></div>"})),mahu.getHistory().addListener(history.entryTypes.ALL,history.eventTypes.ALL,function(e,t,s){a()});const a=function(){$.isFunction(t.getActionState)&&t.menuOptions.forEach(function(e){l(e)})},l=function(e){let n=e.id,a=i.find("a[id='"+n+"']"),l=t.getActionState.call(t.handler,n,s);!0===l&&$(a).show(),!1===l&&$(a).hide()};return{render:function(){let l=document.createElement("div");l.classList.add("contextMenu"),l.classList.add("cmright"),l.style.display="none";let d=document.createElement("a");d.classList.add("contextMenuButton"),d.classList.add("no-change"),t.additionalCssClasses.button&&d.classList.add(t.additionalCssClasses.button),d.setAttribute("title",t.label||Localization.getString("actionmenu")),d.setAttribute("tabindex","0");let o=document.createElement("i");if(o.classList.add("fa"),o.classList.add("fa-bars"),t.additionalCssClasses.icon)if(Array.isArray(t.additionalCssClasses.icon))for(let e=0;e<t.additionalCssClasses.icon.length;++e)o.classList.add(t.additionalCssClasses.icon[e]);else o.classList.add(t.additionalCssClasses.icon);if(o.setAttribute("aria-hidden","true"),d.append(o),t.additionalElement){let e=$(t.additionalElement);d.append(e[0])}e.append(d),e.append(l),t.staticMenu?d.style.display="block":(e.hover(function(e){d.style.display="block"},function(e){d.style.display="none"}),e.focus(function(){d.style.display="block"}).blur(function(e){e.relatedTarget===d||$(l).is(":visible")||(d.style.display="none")}),$(d).blur(function(){$(l).is(":visible")||(d.style.display="none")}));$(d).on("click keyup",function(e){if("keyup"==e.type&&13!=e.originalEvent.keyCode)return!0;e.preventDefault(),e.stopPropagation(),function(){const e=function(e){l.style.display="none",l.classList.remove("cmleft"),l.classList.add("cmright")};if("none"==l.style.display){l.style.display="";let t=$(l),s=t.offset(),i=t.outerWidth(!0);window.innerWidth<s.left+i?(t.removeClass("cmright"),t.addClass("cmleft"),t.offset().left<0&&t.offset({left:3,top:t.offset().top+$(d).height()+10})):(t.removeClass("cmleft"),t.addClass("cmright"));let n=function(t){"a"!=t.target.localName&&t.preventDefault(),e(),window.removeEventListener("click",n)};window.addEventListener("click",n)}else e()}()}),(i=$(l)).html(n),i.find("a").each(function(){let e=$(this),n=e.attr("id");e.on("click keyup",function(e){if("keyup"==e.type&&13!=e.originalEvent.keyCode)return!0;e.preventDefault(),e.stopPropagation(),i.hide();let l=null;for(let e=0;e<t.menuOptions.length;++e){let s=t.menuOptions[e];if(s.id==n){l=s;break}}t.handler.call(t.handler,n,s,l),a()})}),a()}}};