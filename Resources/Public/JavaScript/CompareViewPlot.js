const CompareViewPlot=function(e,t){let n=!0;{let e=[];if(void 0===window.d3?(e.push("https://d3js.org/d3.v5.min.js"),e.push("/typo3conf/ext/mahu_frontend/Resources/Public/JavaScript/libs/divgrid.min.js")):void 0===window.d3.divgrid&&e.push("/typo3conf/ext/mahu_frontend/Resources/Public/JavaScript/libs/divgrid.min.js"),void 0===window.ParCoords&&e.push("/typo3conf/ext/mahu_frontend/Resources/Public/JavaScript/libs/parcoords.standalone.min.js"),void 0===$().chosen){e.push("/typo3conf/ext/mahu_frontend/Resources/Public/JavaScript/libs/chosen.jquery.min.js");var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.href="/typo3conf/ext/mahu_frontend/Resources/Public/Css/chosen.jquery.min.css",o.media="all",document.getElementsByTagName("head")[0].appendChild(o)}function i(e){let t=e.shift();var o,l,a;t&&(o=t,l=e,(a=document.createElement("script")).onload=function(){l.length>0?i(l):n=!0},a.src=o,document.getElementsByTagName("head")[0].appendChild(a))}e.length>0&&(n=!1),i(e)}let l=null,a=null,r=null,c=[],d=[],s=null,u={};Object.getOwnPropertyNames(t.properties).forEach(function(n){let o=t.properties[n];for(let t=0;t<e.length;++t){let i=e[t],l=i[n+"_value_min"],a=i[n+"_value_max"];if(i[n+"_value"]||l||a){u[n]=o;break}}});{u.density&&c.push("density"),u.hardness_ShoreD&&c.push("hardness_ShoreD");let e=Object.getOwnPropertyNames(u);for(;c.length<2;)for(let t=0;t<e.length;++t){let n=e[t];if(-1==c.indexOf(n)){c.push(n);break}}}const p=function(t=!1){let n=[];for(let o=0;o<e.length;++o){let i=e[o],l={};t&&(l[Localization.getString("name")]=(i.nameTrade_value||i.name)+(i.altName?" "+i.altName:""));for(let e=0;e<c.length;++e){let t=c[e],n=t+"_value",o=Localization.getString(t),a=i[n]||i[n+"_max"]||i[n+"_min"]||i[t]||void 0;Array.isArray(a)?l[o]=t?a[a.length-1]:a[0]:l[o]=a}n.push(l)}return n},m=function(){let e=p(!1);null!=s&&$(r).html("");let t=d3.scaleLinear().domain([9,50]).range(["steelblue","brown"]).interpolate(d3.interpolateLab);s=ParCoords({nullValueSeparator:"bottom"})("#"+r.id).alpha(.4).color(t);let n={};Object.keys(e[0]).forEach(function(e){n[e]={type:"number"}}),s.data(e).dimensions(n).render().createAxes().brushMode("None"),e=p(!0);let o=d3.divgrid("#compareViewTable");d3.select("#compareViewTable").datum(e).call(o).selectAll(".gridrow").on("mouseover",function(e){s.highlight([e])}).on("mouseout",s.unhighlight),d3.select("#compareViewTable").select(".gridheader").selectAll(".cell").classed("cropText",!0)},h=function(){document.body.removeChild(a),document.body.removeChild(l),window.onresize=null,$("body").removeClass("noscroll"),y(null,CompareView.eventTypes.CLOSED)},g=function(e){let t=$(e);t.css({left:Math.max(($("body").width()-t.outerWidth())/2,0),top:Math.max((window.innerHeight-t.outerHeight())/2,0)})},f=function(e,t,n){let o=-1;for(let i=0;i<d.length;++i){let l=d[i];if(l.eventType==e&&l.handler==t&&l.scope==n){o=i;break}}return o},y=function(e,t){d.forEach(function(n){if(n.eventType&&n.eventType==t||n.eventType==CompareView.eventTypes.ALL||!n.eventType)try{n.handler.call(n.scope,e,t)}catch(e){console.error(e)}})};return{render:function(){if(!n){let e=this;return void setTimeout(function(){e.render()},200)}(a=document.createElement("div")).classList.add("overlay"),(l=document.createElement("div")).id="compareViewContainer";let t=document.createElement("i");t.classList.add("fas"),t.classList.add("fa-times");let o=document.createElement("a");o.id="compareViewCloseRightUpper",o.setAttribute("tabindex","0"),o.classList.add("pull-right"),o.appendChild(t);let i=document.createElement("h3");i.innerText=Localization.getString("compView.heading"),(r=document.createElement("div")).id="parCoordsWidget",r.classList.add("parcoords"),r.style="height:340px";let d=document.createElement("div");d.id="compareViewTable";let s=document.createElement("div"),p=document.createElement("div");p.classList.add("compareViewHeader","tx_find");let f=document.createElement("div");f.appendChild(r),f.appendChild(d),f.style="overflow:auto;",l.style="width: auto",l.appendChild(o),l.appendChild(i),l.appendChild(p),l.appendChild(f),l.appendChild(s),document.body.appendChild(a),document.body.appendChild(l);let y=Localization.getString("compViewPlot.selectProps")+"<select multiple='true' id='compareViewPropertySelector' class='chosen-container chosen-container-multi inputContainer'>";Object.getOwnPropertyNames(u).forEach(function(e){-1!=c.indexOf(e)?y+="<option selected value='"+e+"'>"+Localization.getString(e)+"</option>":y+="<option value='"+e+"'>"+Localization.getString(e)+"</option>"}),y+="</select>",$(p).html(y),$("#compareViewPropertySelector").chosen({allow_single_deselect:!0,max_selected_options:6}).change(function(e,t){c.length=0;let n=e.target.selectedOptions;for(let e=0;e<n.length;++e)c.push(n[e].value);m(),g(l),setTimeout(function(){m(),g(l)},10)});let b=document.getElementById("compareViewPropertySelector_chosen");b&&(b.style="width:100% !important"),y='<div class="buttonbar"><button id="compare-back" class="btn btn-primary">'+Localization.getString("compView.back")+"</button>",y+='<button id="compare-close" class="btn btn-primary">'+Localization.getString("compView.close")+"</button>",y+="</div>";let v=$(s);v.html(y),$("#compareViewCloseRightUpper").on("click keyup",function(e){"keyup"===e.type&&13!=e.keyCode||h()}),v.find("#compare-close").click(function(){h()}),v.find("#compare-back").click(function(){h();let t=mahu.getMaterialSelector();for(let n=0;n<e.length;++n){let o=e[n],i=o.nameTrade_value||o.name,l={id:o.id,category:o.category,link:o.link,imageURL:o.imageURL,isSymbolicImage:o.isSymbolicImage,producer:o.producer,query:o.query,name:i,altName:o.altName};t.addMaterial(l)}t.show()}),m(),$("body").addClass("noscroll"),g(l),window.onresize=function(){m(),g(l)},m(),g(l)},addListener:function(e,t,n){if(!$.isFunction(t))return!1;return-1==f(e,t,n)&&(d.push({eventType:e,handler:t,scope:n}),!0)},removeListener:function(e,t,n){let o=f(e,t,n);return-1!=o&&(d.splice(o,1),!0)}}};