const MaterialClassSelector=function(e,t=!1,a){let l=[],i=[];const n=mahu.getTaxonomy(),r=function(e,t,a,l){let i=document.createElement("div");i.classList.add("flexResultLine");for(let a=0;a<t.length;++a){let n=t[a];if(n.hidden)continue;let s=c(n,e);$(i).append(s).data(n),l&&Array.isArray(n.children)&&r(e+1,n.children)}return a.append(i),i},s=function(e){let t=0;for(let a=0;a<i.length;a+=2){if(i[a]==e){t=i[a+1];break}}return t},c=function(e,a){let l=n.getLabel(e.id),i='<div class="materialClassTag layer'+a+"Element";if(t){let t=s(e.id);0==t?i+=" disabled":l+=" ("+t+")"}return i+='" ',e.facetValue&&(i+='data-facetValue="'+e.facetValue+'"'),i+'data-id="'+e.id+'"><div ><span class="cropText">'+l+"</span></div></div>"},d=function(){r(1,[n.getMaterialClass("Verbundwerkstoffe")],e,!1),r(1,[n.getMaterialClass("Werkstoffe")],e,!1),r(2,[n.getMaterialClass("Metalle"),n.getMaterialClass("Nichtmetalle")],e,!1),r(3,[n.getMaterialClass("Eisenmetalle"),n.getMaterialClass("Nichteisenmetalle"),n.getMaterialClass("Anorganisch"),n.getMaterialClass("Organisch")],e,!1);let a=document.createElement("div");a.id="lowerMaterialCategories",a.classList.add("flexResultLine"),e.append(a),r(4,[n.getMaterialClass("Stähle"),n.getMaterialClass("Eisengusswerkstoffe"),n.getMaterialClass("Leichtmetalle"),n.getMaterialClass("Schwermetalle"),n.getMaterialClass("Anorganisch-natürlich"),n.getMaterialClass("Anorganisch-synthetisch"),n.getMaterialClass("Organisch-natürlich"),n.getMaterialClass("Organisch-synthetisch")],a,!1).style="width: 100%",function(e,a){let l=document.createElement("div");l.classList.add("flexResultLine"),l.style="width: 100%";for(let a=0;a<e.length;++a){let i=document.createElement("div");i.classList.add("layer4Element");for(let l=0;l<e[a].length;++l){let r=e[a][l];if(r.hidden)continue;let d=n.getLabel(r.id),o='<div class="materialClassTag layer5Element';if(t){let e=s(r.id);0==e?o+=" disabled":d+=" ("+e+")"}if(o+='" ',r.facetValue&&(o+='data-facetValue="'+r.facetValue+'"'),o+='data-id="'+r.id+'"><div><span class="cropText">'+d+"</span></div>",Array.isArray(r.children)){o+="<div>";for(let e=0;e<r.children.length;++e)o+=c(r.children[e],6);o+="</div>"}o+="</div>",$(i).append(o)}l.append(i)}a.append(l)}([n.getChildren("Stähle"),n.getChildren("Eisengusswerkstoffe"),n.getChildren("Leichtmetalle"),n.getChildren("Schwermetalle"),n.getChildren("Anorganisch-natürlich"),n.getChildren("Anorganisch-synthetisch"),n.getChildren("Organisch-natürlich"),n.getChildren("Organisch-synthetisch")],a);let l=document.createElement("div");l.id="materialCategoryExpander",$(l).html('<a><i class="fas fa-chevron-circle-down" title="'+Localization.getString("matClassSel.expand")+'"></i></a>'),e.append(l);let i=$("#materialCategoryExpander");i.click(function(e){let t=$("#lowerMaterialCategories"),a=t.is(":visible"),l=i.find("i")[0];if(l){let e="fa-chevron-circle-up",t="fa-chevron-circle-down";a?l.setAttribute("title",Localization.getString("matClassSel.expand")):(e="fa-chevron-circle-down",t="fa-chevron-circle-up",l.setAttribute("title",Localization.getString("matClassSel.collapse"))),l.classList.remove(e),l.classList.add(t)}a?t.css("display","none"):t.css("display","flex"),e.preventDefault()}),$(e).find(".materialClassTag").click(function(e){e.stopPropagation(),e.preventDefault(),h(MaterialClassSelector.events.itemSelected,{facetValue:e.currentTarget.getAttribute("data-facetValue"),id:e.currentTarget.getAttribute("data-id")})})},o=function(e,t,a){let i=-1;for(let n=0;n<l.length;++n){let r=l[n];if(r.eventName==e&&r.handler==t&&r.scope==a){i=n;break}}return i},h=function(e,t){l.forEach(function(a){if(a.eventName==e)try{a.handler.call(a.scope,t)}catch(e){console.error(e)}})};return{render:function(){$.ajax(mahu.getTermLink("category_unstemmed","json-all"),{accepts:"text/json",async:!0,contentType:"text/json",dataType:"json",crossDomain:!0}).always(function(e){i=e.terms.category_unstemmed;let t=s("Metalle")+s("Nichtmetalle");i=["Werkstoffe",t].concat(i);let a=s("Keramik")+s("Gläser")+s("Anorganische Bindemittel"),l=s("Kunststoffe"),n=s("Pflanzliche Stoffe")+s("Tierische Stoffe"),r=s("Natürlich")-n;i=["Anorganisch-natürlich",r,"Anorganisch-synthethisch",a,"Organisch-natürlich",n,"Organisch-synthetisch",l].concat(i),d()})},addListener:function(e,t,a){if(!$.isFunction(t))return!1;return-1==o(e,t,a)&&(l.push({eventName:e,handler:t,scope:a}),!0)},removeListener:function(e,t,a){let i=o(e,t,a);return-1!=i&&(l.splice(i,1),!0)}}};Object.defineProperties(MaterialClassSelector,{events:{value:Object.defineProperties({},{itemSelected:{value:"itemselected",configurable:!1,enumerable:!0,writable:!1}}),writeable:!1,enumerable:!0,configurable:!1}});